# HG changeset patch
# Parent beaa93d4f6b523d61d3ababb0a68262a83d76584

diff --git a/js/src/jsapi.h b/js/src/jsapi.h
--- a/js/src/jsapi.h
+++ b/js/src/jsapi.h
@@ -1455,16 +1455,32 @@ struct JSExtendedClass {
     JSClass             base;
     JSEqualityOp        equality;
     JSObjectOp          outerObject;
     JSObjectOp          innerObject;
     JSIteratorOp        iteratorObject;
     JSObjectOp          wrappedObject;          /* NB: infallible, null
                                                    returns are treated as
                                                    the original object */
+    /*
+     * All or none of these virtual property hooks must be null.  If non-null,
+     * they will be consulted by the engine after it checks for real (in-scope)
+     * properties.  These hooks need not themselves be aware of real properties;
+     * for instance, if implementing an array-like class, these hooks might only
+     * need to know about the array elements, not .length.
+     */
+    JSBool (*hasOwnVirtualProperty)(JSContext *cx, JSObject *obj, jsid id,
+                                    JSBool *foundp);
+    JSBool (*getOwnVirtualProperty)(JSContext *cx, JSObject *obj, jsid id,
+                                    jsval *vp);
+    JSBool (*setOwnVirtualProperty)(JSContext *cx, JSObject *obj, jsid id,
+                                    jsval *vp);
+    JSBool (*getOwnVirtualDescriptor)(JSContext *cx, JSObject *obj, jsid id,
+                                      JSPropertyDescriptor *desc);
+
     void                (*reserved0)(void);
     void                (*reserved1)(void);
     void                (*reserved2)(void);
 };
 
 #define JSCLASS_HAS_PRIVATE             (1<<0)  /* objects have private slot */
 #define JSCLASS_NEW_ENUMERATE           (1<<1)  /* has JSNewEnumerateOp hook */
 #define JSCLASS_NEW_RESOLVE             (1<<2)  /* has JSNewResolveOp hook */
